{"ast":null,"code":"import _classCallCheck from \"D:/Github/Ciclo-4/Front_Generica/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"D:/Github/Ciclo-4/Front_Generica/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _regeneratorRuntime from \"D:/Github/Ciclo-4/Front_Generica/node_modules/@babel/runtime/regenerator\";\nimport { __awaiter } from \"tslib\";\nimport { HttpClient } from '@angular/common/http';\nimport { Subject, throwError } from 'rxjs';\nimport { catchError } from 'rxjs/operators';\nimport { FileUploadService } from './file-upload.service';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/common/http\";\nimport * as i2 from \"./file-upload.service\";\nimport * as i3 from \"@angular/common\";\nimport * as i4 from \"angular-datatables\";\n\nfunction ProductosComponent_h3_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"h3\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var dato_r2 = ctx.$implicit;\n    var i_r3 = ctx.index;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate2(\" Dato \", i_r3, \" obtuvo codigo \", dato_r2[0], \" \");\n  }\n}\n\nfunction ProductosComponent_tr_26_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"tr\", 8);\n    i0.ɵɵelementStart(1, \"td\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"td\");\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"td\");\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"td\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"td\");\n    i0.ɵɵtext(10);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"td\");\n    i0.ɵɵtext(12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"td\");\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    var Producto_r4 = ctx.$implicit;\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.codigoproducto);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.ivacompra);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.nitproveedor);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.nombreproducto);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.preciocompra);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(Producto_r4.precioventa);\n  }\n}\n\nexport var ProductosComponent = /*#__PURE__*/(function () {\n  var ProductosComponent = /*#__PURE__*/function () {\n    //Función constructora\n    function ProductosComponent(objetohttp, fileUploadService) {\n      _classCallCheck(this, ProductosComponent);\n\n      this.objetohttp = objetohttp;\n      this.fileUploadService = fileUploadService; ///////////////// GET /////////////////////////////\n      //opciones y objeto revisor de la tabla\n\n      this.dtOptions = {};\n      this.dtTrigger = new Subject(); //url api get\n\n      this.urlapiGET = \"http://localhost:8080/api/productos\"; ///////////////// POST /////////////////////////////\n\n      this.codigoRespuesta = 0; //variable de confimación de recepcion de archivo\n\n      this.recibido = false;\n    } //FUNCIÓN DE CONTROL DE ERRORES\n\n\n    _createClass(ProductosComponent, [{\n      key: \"handleError\",\n      value: function handleError(error) {\n        var errorMessage = 'Error desconocido!';\n\n        if (error.error instanceof ErrorEvent) {\n          // Errores del lado del cliente\n          errorMessage = \"Error: \".concat(error.error.message, \"\\n \").concat(error.status);\n        } else {\n          // Errores del lado del servidor\n          errorMessage = \"Codigo de Error: \".concat(error.status, \" \\nMensaje: \").concat(error.message);\n        } //MOSTRANDO UN ERROR EN UNA ALERTA\n        //window.alert(errorMessage);\n\n\n        return throwError(errorMessage);\n      } //aliminando objeto revisor de cambios de la tabla\n\n    }, {\n      key: \"ngOnDestroy\",\n      value: function ngOnDestroy() {\n        this.dtTrigger.unsubscribe();\n      } ///////////////// METODOS ANGULAR /////////////////////////////\n      //FUNCIÓN DE EJECUCIÓN ANTES DE LA CARGA DE LA PAGINA\n\n    }, {\n      key: \"ngOnInit\",\n      value: function ngOnInit() {\n        var _this = this;\n\n        //utilizando el servicio en la url\n        this.res = this.objetohttp.get(this.urlapiGET).pipe(catchError(this.handleError)); //suscribe el archivo json y lo convierte   \n\n        this.res.subscribe(function (datos) {\n          _this.contenido = datos;\n          console.log(_this.contenido);\n\n          _this.dtTrigger.next(_this.dtOptions);\n        }); //Opciones especiales de la tabla, localización y caracteristicas\n\n        this.dtOptions = {\n          pagingType: 'full_numbers',\n          columns: [{\n            title: 'Code'\n          }, {\n            title: 'Nombre'\n          }, {\n            title: 'Pais'\n          }],\n          pageLength: 10,\n          responsive: true,\n          language: {\n            processing: \"Procesando...\",\n            search: \"Buscar:\",\n            lengthMenu: \"Mostrar _MENU_ elementos\",\n            info: \"Mostrando desde _START_ al _END_ de _TOTAL_ elementos\",\n            infoEmpty: \"Mostrando ningún elemento.\",\n            infoFiltered: \"(filtrado _MAX_ elementos total)\",\n            infoPostFix: \"\",\n            loadingRecords: \"Cargando registros...\",\n            zeroRecords: \"No se encontraron registros\",\n            emptyTable: \"No hay datos disponibles en la tabla\",\n            paginate: {\n              first: \"Primero\",\n              previous: \"Anterior\",\n              next: \"Siguiente\",\n              last: \"Último\"\n            },\n            aria: {\n              sortAscending: \": Activar para ordenar la tabla en orden ascendente\",\n              sortDescending: \": Activar para ordenar la tabla en orden descendente\"\n            }\n          }\n        };\n      } // En caso de seleccionar archivo, escojer el primer archivo\n\n    }, {\n      key: \"onChange\",\n      value: function onChange(event) {\n        this.file = event.target.files[0];\n      } // Cuandop haga click, iniciar proceso de envio\n\n    }, {\n      key: \"onUpload\",\n      value: function onUpload() {\n        return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n          return _regeneratorRuntime.wrap(function _callee$(_context) {\n            while (1) {\n              switch (_context.prev = _context.next) {\n                case 0:\n                  console.log(this.file);\n                  _context.next = 3;\n                  return this.fileUploadService.upload(this.file);\n\n                case 3:\n                  this.resultados = _context.sent;\n                  console.log(this.resultados);\n\n                case 5:\n                case \"end\":\n                  return _context.stop();\n              }\n            }\n          }, _callee, this);\n        }));\n      }\n    }]);\n\n    return ProductosComponent;\n  }();\n\n  ProductosComponent.ɵfac = function ProductosComponent_Factory(t) {\n    return new (t || ProductosComponent)(i0.ɵɵdirectiveInject(i1.HttpClient), i0.ɵɵdirectiveInject(i2.FileUploadService));\n  };\n\n  ProductosComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: ProductosComponent,\n    selectors: [[\"app-productos\"]],\n    decls: 27,\n    vars: 5,\n    consts: [[1, \"content\"], [1, \"text-center\"], [\"type\", \"file\", 1, \"form-control\", 3, \"change\"], [1, \"btn\", \"btn-success\", 3, \"click\"], [1, \"container\"], [4, \"ngFor\", \"ngForOf\"], [\"datatable\", \"\", 1, \"compact\", \"nowrap\", \"table\", \"table-dark\", \"table-hover\", \"table-sm\", 3, \"dtOptions\", \"dtTrigger\"], [\"class\", \"\", 4, \"ngFor\", \"ngForOf\"], [1, \"\"]],\n    template: function ProductosComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵelementStart(1, \"div\", 1);\n        i0.ɵɵelementStart(2, \"input\", 2);\n        i0.ɵɵlistener(\"change\", function ProductosComponent_Template_input_change_2_listener($event) {\n          return ctx.onChange($event);\n        });\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(3, \"button\", 3);\n        i0.ɵɵlistener(\"click\", function ProductosComponent_Template_button_click_3_listener() {\n          return ctx.onUpload();\n        });\n        i0.ɵɵtext(4, \" Subir Archivo \");\n        i0.ɵɵelementEnd();\n        i0.ɵɵtext(5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(6, \"div\", 4);\n        i0.ɵɵtemplate(7, ProductosComponent_h3_7_Template, 2, 2, \"h3\", 5);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(8, \"table\", 6);\n        i0.ɵɵelementStart(9, \"thead\");\n        i0.ɵɵelementStart(10, \"tr\");\n        i0.ɵɵelementStart(11, \"th\");\n        i0.ɵɵtext(12, \"ID Producto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(13, \"th\");\n        i0.ɵɵtext(14, \"C\\xF3digo Producto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(15, \"th\");\n        i0.ɵɵtext(16, \"IVA Compra\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(17, \"th\");\n        i0.ɵɵtext(18, \"NIT Proveedor\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(19, \"th\");\n        i0.ɵɵtext(20, \"Nombre Producto\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(21, \"th\");\n        i0.ɵɵtext(22, \"Precio Compra\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(23, \"th\");\n        i0.ɵɵtext(24, \"Precio Venta\");\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementStart(25, \"tbody\");\n        i0.ɵɵtemplate(26, ProductosComponent_tr_26_Template, 15, 7, \"tr\", 7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵadvance(5);\n        i0.ɵɵtextInterpolate1(\" \", ctx.recibido, \" \");\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.resultados);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"dtOptions\", ctx.dtOptions)(\"dtTrigger\", ctx.dtTrigger);\n        i0.ɵɵadvance(18);\n        i0.ɵɵproperty(\"ngForOf\", ctx.contenido);\n      }\n    },\n    directives: [i3.NgForOf, i4.DataTableDirective],\n    styles: [\"\"]\n  });\n  return ProductosComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}