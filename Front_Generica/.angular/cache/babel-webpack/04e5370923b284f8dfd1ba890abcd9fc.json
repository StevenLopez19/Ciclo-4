{"ast":null,"code":"import _classCallCheck from \"C:/Users/Luisa L/Documents/Ciclo 4/Front_Generica/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"C:/Users/Luisa L/Documents/Ciclo 4/Front_Generica/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _regeneratorRuntime from \"C:/Users/Luisa L/Documents/Ciclo 4/Front_Generica/node_modules/@babel/runtime/regenerator\";\nimport { __awaiter, __decorate, __metadata } from \"tslib\";\nimport { Component } from \"@angular/core\";\nimport { HttpClient } from \"@angular/common/http\";\nimport { Subject, throwError } from \"rxjs\";\nimport { catchError } from \"rxjs/operators\";\nimport { FileUploadService } from \"./file-upload.service\";\n\nvar ProductosComponent = /*#__PURE__*/function () {\n  //Función constructora\n  function ProductosComponent(objetohttp, fileUploadService) {\n    _classCallCheck(this, ProductosComponent);\n\n    this.objetohttp = objetohttp;\n    this.fileUploadService = fileUploadService; ///////////////// GET /////////////////////////////\n    //opciones y objeto revisor de la tabla\n\n    this.dtOptions = {};\n    this.dtTrigger = new Subject(); //url api get\n\n    this.urlapiGET = \"http://localhost:8080/api/productos\"; ///////////////// POST /////////////////////////////\n\n    this.codigoRespuesta = 0; //variable de confimación de recepcion de archivo\n\n    this.recibido = false;\n  } //FUNCIÓN DE CONTROL DE ERRORES\n\n\n  _createClass(ProductosComponent, [{\n    key: \"handleError\",\n    value: function handleError(error) {\n      var errorMessage = \"Error desconocido!\";\n\n      if (error.error instanceof ErrorEvent) {\n        // Errores del lado del cliente\n        errorMessage = \"Error: \".concat(error.error.message, \"\\n \").concat(error.status);\n      } else {\n        // Errores del lado del servidor\n        errorMessage = \"Codigo de Error: \".concat(error.status, \" \\nMensaje: \").concat(error.message);\n      } //MOSTRANDO UN ERROR EN UNA ALERTA\n      //window.alert(errorMessage);\n\n\n      return throwError(errorMessage);\n    } //aliminando objeto revisor de cambios de la tabla\n\n  }, {\n    key: \"ngOnDestroy\",\n    value: function ngOnDestroy() {\n      this.dtTrigger.unsubscribe();\n    } ///////////////// METODOS ANGULAR /////////////////////////////\n    //FUNCIÓN DE EJECUCIÓN ANTES DE LA CARGA DE LA PAGINA\n\n  }, {\n    key: \"ngOnInit\",\n    value: function ngOnInit() {\n      var _this = this;\n\n      //utilizando el servicio en la url\n      this.res = this.objetohttp.get(this.urlapiGET).pipe(catchError(this.handleError)); //suscribe el archivo json y lo convierte\n\n      this.res.subscribe(function (datos) {\n        _this.contenido = datos;\n        console.log(_this.contenido);\n\n        _this.dtTrigger.next(_this.dtOptions);\n      }); //Opciones especiales de la tabla, localización y caracteristicas\n\n      this.dtOptions = {\n        pagingType: \"full_numbers\",\n        columns: [{\n          title: \"Id\"\n        }, {\n          title: \"Código\"\n        }, {\n          title: \"Iva Compra\"\n        }, {\n          title: \"Nit Proveedor\"\n        }, {\n          title: \"Nombre\"\n        }, {\n          title: \"Precio Compra\"\n        }, {\n          title: \"Precio Venta\"\n        }],\n        pageLength: 10,\n        responsive: true,\n        language: {\n          processing: \"Procesando...\",\n          search: \"Buscar:\",\n          lengthMenu: \"Mostrar _MENU_ elementos\",\n          info: \"Mostrando desde _START_ al _END_ de _TOTAL_ elementos\",\n          infoEmpty: \"Mostrando ningún elemento.\",\n          infoFiltered: \"(filtrado _MAX_ elementos total)\",\n          infoPostFix: \"\",\n          loadingRecords: \"Cargando registros...\",\n          zeroRecords: \"No se encontraron registros\",\n          emptyTable: \"No hay datos disponibles en la tabla\",\n          paginate: {\n            first: \"Primero\",\n            previous: \"Anterior\",\n            next: \"Siguiente\",\n            last: \"Último\"\n          },\n          aria: {\n            sortAscending: \": Activar para ordenar la tabla en orden ascendente\",\n            sortDescending: \": Activar para ordenar la tabla en orden descendente\"\n          }\n        }\n      };\n    } // En caso de seleccionar archivo, escojer el primer archivo\n\n  }, {\n    key: \"onChange\",\n    value: function onChange(event) {\n      this.file = event.target.files[0];\n    } // Cuandop haga click, iniciar proceso de envio\n\n  }, {\n    key: \"onUpload\",\n    value: function onUpload() {\n      return __awaiter(this, void 0, void 0, /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                console.log(this.file);\n                _context.next = 3;\n                return this.fileUploadService.upload(this.file);\n\n              case 3:\n                this.resultados = _context.sent;\n                console.log(this.resultados);\n\n              case 5:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n    }\n  }, {\n    key: \"postData\",\n    value: function postData() {\n      var _this2 = this;\n\n      this.objetohttp.post(\"http://localhost:8080/api/productos\", {\n        codigoproducto: this.resultados[0],\n        ivacompra: this.resultados[1],\n        nitproveedor: this.resultados[2],\n        nombreproducto: this.resultados[3],\n        preciocompra: this.resultados[4],\n        precioventa: this.resultados[5]\n      }, {\n        observe: \"response\"\n      }).subscribe(function (response) {\n        _this2.codigoRespuesta = response.status;\n      });\n    }\n  }]);\n\n  return ProductosComponent;\n}();\n\nProductosComponent = __decorate([Component({\n  selector: \"app-productos\",\n  templateUrl: \"./productos.component.html\",\n  styleUrls: [\"./productos.component.scss\"]\n}), __metadata(\"design:paramtypes\", [HttpClient, FileUploadService])], ProductosComponent);\nexport { ProductosComponent };","map":null,"metadata":{},"sourceType":"module"}